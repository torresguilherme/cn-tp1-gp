\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amssymb}
\usepackage{booktabs}
\usepackage{array}
\usepackage{pgfplotstable}
\pgfplotstableset{
  empty cells with={---},
  every head row/.style={before row=\toprule,after row=\midrule},
  every last row/.style={after row=\bottomrule}
}
\pgfplotsset{compat=1.9}

\begin{document}

\title{Computação Natural - TP1 - Programação Genética}
\author{Guilherme Torres (Departamento de Ciência da Computação - UFMG)}
\date{}
\maketitle

\section{Introdução}

O objetivo deste trabalho foi formular e escolher os melhores parâmetros para um algoritmo de aprendizado para regressão simbólica. Dada uma função $f: \mathbb{R}^n \to \mathbb{R}$, a regressão simbólica consiste em tentar aproximar essa função usando uma árvore constituída por terminais nas folhas (constantes ou variáveis) e operadores.
	
A heurística usada foi a programação genética, que usa de conceitos evolucionários para evoluir as soluções para o problema e obter indivíduos mais adaptados. É um algoritmo estocástico, ou seja, com vários componentes de aleatoriedade como geração inicial dos indivíduos e mutações, o que requer que muitos experimentos sejam realizados para tirar as conclusões sobre o trabalho, que serão discutidos nesse documento.

O algoritmo foi implementado em Python 3, na pasta /src. Instruções para executar o teste estão explicitadas no arquivo README.md. O programa também pode ser encontrado no repositório:

\texttt{https://github.com/torresguilherme/cn-tp1-gp}.

\section{Implementação}

\subsection{Fundamentação}

O funcionamento do algoritmo pode ser descrito, no plano geral, pelos seguintes passos:

\begin{enumerate}
	\item Geração aleatória dos primeiros indivíduos;
	\item Mostra a melhor, pior e média das fitness na população;
	\item Adiciona o grupo elitista à nova população;
	\item Repete até que o número de indivíduos na população possa ser reposto:
	\begin{enumerate}
		\item Seleciona dois pais através do torneio;
		\item Aplica a probabilidade de cruzamento;
		\item Ao se obter um cruzamento, aplica a chance de mutação;
		\item Adiciona os filhos gerados à nova população;
	\end{enumerate}
	\item Repete desde o passo 2, até que o número máximo de gerações seja alcançado.
\end{enumerate}

Como é sugerido, há muitas variáveis envolvidas e deve-se encontrar o valor ótimo para elas por meio de experimentos.

\subsection{Decisões de implementação}

\begin{figure}[!ht]
    \centering
    \begin{tikzpicture}
      \begin{axis}
        \addplot table [x index = 0, y index = 1] {data.txt};
        \addplot table [x index = 0, y index = 2] {data.txt};
      \end{axis}
    \end{tikzpicture}
    \caption{Data plot}
    \label{fig:data}
  \end{figure}
  
\subsection*{Indivíduo}

Um indivíduo é representado por uma árvore, que tem um valor de uma função. Cada uma das folhas da árvore faz o papel de uma constante ou uma variável. As constantes são geradas aleatoriamente com números de ponto flutuante entre -10 e 10 (distribuição uniforme).

Os operadores escolhidos foram '+', '*' e '/', respectivamente, para adição, multiplicação e divisão. Como a subtração é praticamente uma adição por um número negativo, não foi necessário adicionar um operador '-'. 

\subsection*{Geração aleatória de indivíduos}

Cada indivíduo começa com um operador a priori, e sua árvore é estendida até que todos os caminhos acabem em um terminal. Como a profundidade máxima do indivídio é 7, apenas terminais serão escolhidos aleatoriamente quando algum nó chegar na profundidade 6.

\subsection{Cálculo da Fitness}

A fitness de um indivíduo é dada pelo seu erro quadrático em relação ao resultado dado para um conjunto de variáveis da função que se quer aprender. 

\subsection*{Seleção natural}

A seleção é realizada por torneiro. Dado um tamanho de torneio $T$, uma amostra de tamanho $T$ é selecionada também de forma aleatória entre os indivíduos e o vencedor é o que tiver a melhor fitness, no caso, o menor erro quadrático. 

A variável $T$ é o principal fator que define a intensidade da pressão seletiva na população. Quanto maior esse número é, mais difícil é a permanência de indivíduos com fitness pior do que a média na população. Por isso, o valor adequado para esse parâmetro também foi definido através de experimentos, dentro de um intervalo de valores.

\subsection*{Cruzamento}

O cruzamento também faz parte da seleção natural. Ele ocorre para definir a nova geração a ser avaliada no GP. Dados dois indivíduo que venceram seus respectivos torneios, a probabilidade de ocorrer um cruzamento entre eles subsequentemente é de $p_c$ (entre 60\% e 90\%).

Uma das principais questões do cruzamento é a possibilidade de se manter a localidade ao cruzar duas árvores (se 	uma grande parte das árvores for cruzada, a variabilidade gerada pode levar a um indivíduo completamente diferente dos dois pais, o que aumenta drasticamente a aleatoriedade da busca).

Para evitar que um crossover provoque uma variedade maior do que deveria e destrua bons indivíduos, o modelo de crossover adotado é o citado por (insira autor) como o método mais simples, que é a troca de duas folhas aleatoriamente escolhidas entre os pais.

\subsection*{Mutação}

Como o cruzamento é escolhido de forma bem conservadora, é papel da mutação provocar uma variabiidade mais drástica e promover a diversidade entre a população. A estratégia usada também é citada por (insira autor), e consiste em escolher um nó aleatório da árvore, podar os seus filhos e re-extender a árvore aleatoriamente a partir desse ponto.

Para cada indivíduo que surge de um cruzamento, a chance de ele sofrer uma mutação é $p_m$ (entre 5\% e 30\%).

\subsection*{Elitismo}

Passar um pequeno grupo dos melhores indivíduos da população atual para a próxima geração sem submetê-los ao processo de seleção é um processo muito utilizado para fazer algoritmos convergir mais rápido e preservar bons genótipos. O elitismo é adotado neste projeto também.

Como o número de indivíduos da população é relativamente pequeno, fixo em 50, julgou-se razoável manter o tamanho do grupo elitista em apenas um, para que a pressão seletiva não fosse desproporcional e assim, evitando que todos os indivíduos ficassem iguais antes do número de iterações desejado.

\section{Experimentos}

\section{Conclusões}

\section{Referências}

\end{document}